"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var article,url,inputValue,items,totalCount,title,permalink,excerpt,thumbnail,categoryName,categoryURL,color,restUrl=blogData.jsonData,$placeholder=document.querySelector(".posts-list"),$cats=document.querySelectorAll(".blog-cats__cat"),$input=document.querySelector(".blog-search__text"),$search=document.querySelector(".search"),$text=document.querySelector(".blog-search__text"),$load=document.querySelector(".blog-load"),$more=document.querySelector(".blog-load_button"),$inner=document.querySelector(".blog-feed__inner");$input.value="";var termsArray=[],loadTimes=0,num=6,offset=0;$cats.forEach(function(e,t){return termsArray[t]=e.getAttribute("data-cat")}),url=restUrl+"?terms=";var animateArticles=function(){var e=document.querySelectorAll(".post"),t=new ScrollMagic.Controller;e.forEach(function(e){new ScrollMagic.Scene({triggerElement:e,offset:-.6*window.innerHeight}).on("enter",function(){}).addTo(t)})},showPosts=function(e,t){var r,a,s="";null!=e[0]&&(items=e[0],totalCount=e[1]),items.forEach(function(e,t){title=e.title,permalink=e.permalink,excerpt=e.excerpt,thumbnail=e.thumbnail,categoryName=e.cat_name,categoryURL=e.cat_url,color=e.color,color="null"===e.color?"000000":e.color,s+='\n      <article class="post">\n        <a class="post__featured" href="'.concat(permalink,'">\n          <figure class="post__figure" style="background-image: url(').concat(thumbnail,')"></figure>\n        </a>\n        <div class="post__info">\n          <a href="').concat(categoryURL,'" class="post__category">\n            <span style="background-color: ').concat(color,'"></span>\n            ').concat(categoryName,'\n          </a>\n          <a href="').concat(permalink,'" class="post__title">').concat(title,'</a>\n          <div class="post__excerpt">\n            ').concat(excerpt,"\n          </div>\n        </div>\n      </article>\n    ")}),t?((r=(a=document.createElement("div")).classList).add.apply(r,["posts-list-extra"]),a.innerHTML=s,$inner.appendChild(a),loadTimes++):$placeholder.innerHTML=s,0==loadTimes?totalCount/(num+1)<=loadTimes+1&&$load.classList.remove("visible"):totalCount/num<=loadTimes+1&&$load.classList.remove("visible")},fetch=function(e,t,r,a,s){var o=new XMLHttpRequest,n=url+e+(s="&posts="+s)+(r="&offset="+r)+("&key="+a);o.open("GET",n),o.onload=function(){var e;200<=o.status&&o.status<400?(0===(e=JSON.parse(o.responseText))[0].length&&($load.classList.remove("visible"),$placeholder.innerHTML='<div class="posts-list__notfound"><h2>No articles found</h2></div>'),0!==e[0].length&&(showPosts(e,t),animateArticles())):console.log("error")},o.onerror=function(){console.log("connection error")},o.send()},init=function(e,t,r,a,s){t||(removeExtra(),loadTimes=r=0,$load.classList.add("visible")),fetch(e,t,r,a,s)},removeExtra=function(){var e=document.querySelector(".posts-list-extra");e&&e.parentNode.removeChild(e)};init(termsArray,!1,0,"",7),$search.addEventListener("click",function(e){e.preventDefault(),inputValue=$text.value,$cats.forEach(function(e){e.classList.remove("expanded")}),""!==inputValue&&($search.querySelector(".fas").classList.contains("fa-search")?($search.querySelector(".fas").classList.remove("fa-search"),$search.querySelector(".fas").classList.add("fa-times")):($search.querySelector(".fas").classList.add("fa-search"),$search.querySelector(".fas").classList.remove("fa-times"),$input.value="",init(termsArray,!1,0,"",7)),init(termsArray,!1,0,inputValue,7))}),$input.addEventListener("focus",function(){""===$text.value&&($cats.forEach(function(e){return e.classList.remove("expanded")}),$cats.forEach(function(e,t){termsArray[t]=e.getAttribute("data-cat")}),init(termsArray,!1,0,"",7))}),$input.addEventListener("keyup",function(e){""===$text.value?($load.classList.add("visible"),init(termsArray,!1,0,"",7),$search.querySelector(".fas").classList.add("fa-search"),$search.querySelector(".fas").classList.remove("fa-times")):$load.classList.remove("visible"),$search.querySelector(".fas").classList.contains("fa-times")&&($search.querySelector(".fas").classList.add("fa-search"),$search.querySelector(".fas").classList.remove("fa-times")),13!=e.which&&13!=e.keyCode||($search.querySelector(".fas").classList.remove("fa-search"),$search.querySelector(".fas").classList.add("fa-times"))}),$cats.forEach(function(r){r.addEventListener("click",function(){var e,t;$input.value="",$search.querySelector(".fas").classList.add("fa-search"),$search.querySelector(".fas").classList.remove("fa-times"),r.classList.contains("expanded")?(r.classList.remove("expanded"),r.getAttribute("data-cat"),$cats.forEach(function(e,t){termsArray[t]=e.getAttribute("data-cat")})):($cats.forEach(function(e){return e.classList.remove("expanded")}),r.classList.add("expanded"),e=r.getAttribute("data-cat"),termsArray=[],(t=document.querySelector(".posts-list-extra"))&&t.parentNode.removeChild(t),termsArray=[].concat(_toConsumableArray(termsArray),[e]),$load.classList.add("visible")),init(termsArray,!1,0,"",7)})}),$load.addEventListener("click",function(){0==loadTimes?offset=num+1:offset+=num;var e=$text.value;""===e?init(termsArray,!0,offset,"",6):($cats.forEach(function(e,t){termsArray[t]=e.getAttribute("data-cat")}),init(termsArray,!0,offset,e,6))});